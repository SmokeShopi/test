<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Anime Ultimate Fix</title>
    <style>
        body { background: #0a0a0a; color: #fff; font-family: sans-serif; text-align: center; padding: 20px; }
        .container { max-width: 900px; margin: auto; }
        .controls { background: #161616; padding: 20px; border-radius: 15px; border: 1px solid #333; margin-bottom: 20px; }
        input { padding: 12px; width: 150px; border-radius: 8px; border: 1px solid #444; background: #222; color: #fff; outline: none; }
        button { padding: 12px 20px; border-radius: 8px; border: none; background: #ff4500; color: #fff; font-weight: bold; cursor: pointer; }
        .mirror-btn { background: #2a2a2a; border: 1px solid #444; padding: 6px 12px; margin: 4px; font-size: 12px; color: #888; cursor: pointer; }
        .mirror-btn.active { border-color: #ff4500; color: #ff4500; background: rgba(255, 69, 0, 0.1); }
        .player-box { position: relative; padding-bottom: 56.25%; height: 0; background: #000; border-radius: 15px; overflow: hidden; border: 1px solid #333; }
        iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }
        .hint { margin-top: 15px; color: #666; font-size: 12px; }
    </style>
</head>
<body>

<div class="container">
    <h1 style="color: #ff4500;">ANIME PLAYER</h1>

    <div class="controls">
        <input type="number" id="shikiId" value="5114" placeholder="ID Shikimori">
        <button onclick="update()">ЗАПУСТИТЬ</button>
        
        <div id="mirrors" style="margin-top: 15px;"></div>
    </div>

    <div class="player-box">
        <iframe id="main-iframe" src="" allowfullscreen referrerpolicy="no-referrer"></iframe>
    </div>
    
    <div class="hint">
        ID 5114 — Стальной Алхимик. ID 20 — Наруто.<br>
        Если пишет "Плеер не найден" на всех кнопках — включите VPN.
    </div>
</div>

<script>
    // Список самых живучих зеркал на 2026 год
    const servers = [
        { name: "Kodik (Осн)", url: "https://kodik.info/find-player?shikimori_id=" },
        { name: "Kodik (Резерв)", url: "https://31348.kodik.online/find-player?shikimori_id=" },
        { name: "Alloha", url: "https://api.alloha.tv/?shikimori_id=" },
        { name: "Collaps", url: "https://api.collaps.org/embed/shikimori/" }
    ];

    let currentBase = servers[0].url;

    function init() {
        const div = document.getElementById('mirrors');
        servers.forEach((s, i) => {
            const b = document.createElement('button');
            b.className = 'mirror-btn' + (i === 0 ? ' active' : '');
            b.innerText = s.name;
            b.onclick = () => {
                currentBase = s.url;
                document.querySelectorAll('.mirror-btn').forEach(btn => btn.classList.remove('active'));
                b.classList.add('active');
                update();
            };
            div.appendChild(b);
        });
        update();
    }

    function update() {
        const id = document.getElementById('shikiId').value;
        const iframe = document.getElementById('main-iframe');
        
        let url = currentBase + id;
        
        // Магия для Kodik: используем расширенный поиск типов
        if (currentBase.includes('kodik')) {
            url += "&types=anime-serial,anime"; 
        }

        iframe.src = url;
    }

    window.onload = init;
</script>

</body>
</html>
