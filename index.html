<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Anime Fix Final</title>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; text-align: center; margin: 0; padding: 20px; }
        .box { max-width: 900px; margin: auto; background: #111; padding: 20px; border-radius: 20px; border: 1px solid #333; }
        input { padding: 12px; border-radius: 10px; border: 1px solid #444; background: #222; color: #fff; width: 120px; }
        button { padding: 12px 20px; border-radius: 10px; border: none; background: #ff4500; color: #fff; cursor: pointer; font-weight: bold; }
        .links { margin: 20px 0; display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; }
        .btn-s { background: #333; padding: 8px 15px; border-radius: 8px; font-size: 12px; color: #eee; cursor: pointer; border: 1px solid #444; }
        .btn-s.active { background: #ff4500; border-color: #ff4500; }
        .player { position: relative; padding-bottom: 56.25%; height: 0; background: #000; border-radius: 15px; overflow: hidden; border: 1px solid #444; }
        iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }
        .warning { color: #666; font-size: 12px; margin-top: 15px; }
    </style>
</head>
<body>

<div class="box">
    <h2 style="color:#ff4500">ANIME NO-TOKEN PLAYER</h2>
    <input type="number" id="id" value="5114">
    <button onclick="play()">ИГРАТЬ</button>

    <div class="links" id="menu"></div>

    <div class="player">
        <iframe id="v" src="" allowfullscreen referrerpolicy="no-referrer"></iframe>
    </div>
    
    <div class="warning">
        Если везде черный экран — попробуйте отключить AdBlock или включить VPN.<br>
        На GitHub Pages часто блокируется "Referrer", мы пытаемся его скрыть.
    </div>
</div>

<script>
    // Самые простые ссылки, которые работают БЕЗ ключей API
    const srvs = [
        { n: "Kodik 1", u: "//kodik.info/find-player?shikimori_id=" },
        { n: "Kodik 2", u: "//kodik.cc/find-player?shikimori_id=" },
        { n: "Kodik 3", u: "//kodik.biz/find-player?shikimori_id=" },
        { n: "Alloha", u: "https://api.alloha.tv/?shikimori_id=" },
        { n: "Collaps", u: "https://api.collaps.org/embed/shikimori/" },
        { n: "Vibix", u: "https://vibix.org/embed/shikimori/" }
    ];

    let cur = 0;

    function build() {
        const m = document.getElementById('menu');
        m.innerHTML = '';
        srvs.forEach((s, i) => {
            const b = document.createElement('div');
            b.className = 'btn-s' + (i === cur ? ' active' : '');
            b.innerText = s.n;
            b.onclick = () => { cur = i; build(); play(); };
            m.appendChild(b);
        });
    }

    function play() {
        const id = document.getElementById('id').value;
        const f = document.getElementById('v');
        let link = srvs[cur].u + id;

        // Для Кодика добавляем фильтр, чтобы не вылезали дорамы
        if (srvs[cur].n.includes("Kodik")) {
            link += "&types=anime-serial,anime";
        }

        f.src = link;
    }

    window.onload = () => { build(); play(); };
</script>

</body>
</html>
